<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Science, meet productivity</title><link href="/" rel="alternate"></link><link href="/feeds/bioinformatics.atom.xml" rel="self"></link><id>/</id><updated>2015-05-06T15:04:00-07:00</updated><entry><title>IGV: Null pointer exceptions, invalid GZIP header, invalid BZIP header</title><link href="/blog/2015/05/06/igv-java-lang-nullpointerexception/" rel="alternate"></link><updated>2015-05-06T15:04:00-07:00</updated><author><name>Olga Botvinnik</name></author><id>tag:,2015-05-06:blog/2015/05/06/igv-java-lang-nullpointerexception/</id><summary type="html">&lt;p&gt;If you&amp;#8217;ve run into a &lt;code&gt;java.lang.NullPointerException&lt;/code&gt; or &amp;#8220;Invalid Gzip Header&amp;#8221; or some complaint about bzip while using the Integrative Genomics Viewer, then you&amp;#8217;ve run into the same problem as me. Turns out I had too many index (&lt;code&gt;*.bai&lt;/code&gt;) files that had similar naming to my &lt;code&gt;*.bam&lt;/code&gt; files, and &lt;span class="caps"&gt;IGV&lt;/span&gt; assigned the wrong ones as the index, so whenever I tried to view reads from those samples, the index pointed to the wrong location in the bam, and one of those many errors would happen. So the solution is simple (and relatively fast): use &lt;code&gt;samtools index&lt;/code&gt; on your bam&amp;nbsp;files!&lt;/p&gt;</summary><category term="bioinformatics"></category><category term="samtools"></category><category term="igv"></category><category term="java"></category></entry><entry><title>How to create a custom genome fasta from a vcf file</title><link href="/blog/2015/04/01/how-to-create-a-custom-genome-fasta-from-a-vcf-file/" rel="alternate"></link><updated>2001-04-15T11:08:00-07:00</updated><author><name>Olga Botvinnik</name></author><id>tag:,2015-04-01:blog/2015/04/01/how-to-create-a-custom-genome-fasta-from-a-vcf-file/</id><summary type="html">&lt;p&gt;I&amp;#8217;ve tried to create a custom genome for the J. Craig Venter genome several times using &lt;code&gt;vcf-consensus&lt;/code&gt; and other tools and they have never worked. Finally, I&amp;#8217;ve gotten something to work, and hopefuly this helps you too! This is a log of all the steps I had to take to create a new reference genome. This requires a few&amp;nbsp;tools:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://samtools.sourceforge.net/"&gt;samtools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://vcftools.sourceforge.net/index.html"&gt;vcftools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://broadinstitute.github.io/picard/"&gt;PicardTools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.broadinstitute.org/gatk/"&gt;&lt;span class="caps"&gt;GATK&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Lucky for me, I already all of these tools installed on our server, but this may not be the case for you. I&amp;#8217;m not the expert on installing these things, for the most part they were installed by other lab members. If you need help with these tools, I suggest searching on &lt;a href="https://www.biostars.org/"&gt;biostars.org&lt;/a&gt; and &lt;a href="http://seqanswers.com/"&gt;seqanswers.com&lt;/a&gt; for&amp;nbsp;advice.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s get started. The goal is to be able to run &lt;a href="https://www.broadinstitute.org/gatk/gatkdocs/org_broadinstitute_gatk_tools_walkers_fasta_FastaAlternateReferenceMaker.php"&gt;&lt;code&gt;FastaAlternativeReferenceMaker&lt;/code&gt;&lt;/a&gt; from &lt;span class="caps"&gt;GATK&lt;/span&gt;, which&amp;nbsp;requires:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Properly prepared reference fasta (we&amp;#8217;ll see what &lt;em&gt;&amp;#8220;properly prepared&amp;#8221;&lt;/em&gt; means in a&amp;nbsp;bit)&lt;/li&gt;
&lt;li&gt;Karyotypically sorted &amp;#8220;variant call format&amp;#8221; (&lt;code&gt;vcf&lt;/code&gt;) file for the new&amp;nbsp;genome.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;First, we need to obtain and decompress human genome assembly. I like to keep my directories organized like the original source, so we&amp;#8217;ll move to the &lt;code&gt;/projects/ps-yeolab/genomes/ensembl/v75/fasta/homo_sapiens/dna/&lt;/code&gt; first. Notice we do this for-loop, that&amp;#8217;s because &lt;span class="caps"&gt;GATK&lt;/span&gt; is extremely strict and requires your reference genome to be in karyotypic order (e.g. &lt;code&gt;1, 2, 3, ...&lt;/code&gt;) not lexicographical order (e.g. &lt;code&gt;1, 10, 11, 12, ...&lt;/code&gt;), and in the exact same order as the &lt;span class="caps"&gt;VCF&lt;/span&gt;, which is sorted in this way. Also, we want to make sure not to download any of the haplotypes or unassembled contigs, e.g. &lt;code&gt;GL000246.1&lt;/code&gt;. Also, notice that the chromosomes are numbered &lt;span class="caps"&gt;ENSEMBL&lt;/span&gt;-style, as &lt;code&gt;1&lt;/code&gt;, &lt;code&gt;2&lt;/code&gt;, &lt;code&gt;3&lt;/code&gt;&amp;#8230; rather than &lt;span class="caps"&gt;UCSC&lt;/span&gt;-style with &lt;code&gt;chr&lt;/code&gt; prepended, as &lt;code&gt;chr1&lt;/code&gt;, &lt;code&gt;chr2&lt;/code&gt;, &lt;code&gt;chr3&lt;/code&gt;, &amp;#8230; Just something to keep in mind in case you need to do this for other genomes, there could be other&amp;nbsp;caveats.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cd /projects/ps-yeolab/genomes/ensembl/v75/fasta/homo_sapiens/dna/
for C in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 MT X Y
do
    curl &amp;quot;ftp://ftp.ensembl.org/pub/release-75/fasta/homo_sapiens/dna/Homo_sapiens.GRCh37.75.dna.chromosome.&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.fa.gz&amp;quot; |\
        gunzip -c &amp;gt;&amp;gt; Homo_sapiens.GRCh37.75.fa
done
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Next, obtain and decompress Venter vcf file. Again, we&amp;#8217;ll do this in the corresponding directory on our server, which matches the folder layout of the &lt;span class="caps"&gt;ENSEMBL&lt;/span&gt; ftp&amp;nbsp;site.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cd /projects/ps-yeolab/genomes/ensembl/v75/variation/vcf/homo_sapiens/
wget ftp://ftp.ensembl.org/pub/release-75/variation/vcf/homo_sapiens/Venter.vcf.gz
gunzip Venter.vcf.gz
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This &lt;span class="caps"&gt;VCF&lt;/span&gt; file is in lexicographically sorted order, so we will use &lt;a href="http://vcftools.sourceforge.net/perl_module.html#vcf-sort"&gt;&lt;code&gt;vcf-sort&lt;/code&gt;&lt;/a&gt; from &lt;code&gt;vcftools&lt;/code&gt; to sort the genome karyotypically, aka in chromosomal&amp;nbsp;order.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;cat Venter.vcf | vcf-sort --chromosomal-order &amp;gt; Venter.sorted.vcf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we need to follow the instructions provided on the &lt;a href="http://gatkforums.broadinstitute.org/discussion/1601/how-can-i-prepare-a-fasta-file-to-use-as-reference"&gt;&lt;span class="caps"&gt;GATK&lt;/span&gt; forums&lt;/a&gt; about how to prepare a fasta file as a&amp;nbsp;reference.&lt;/p&gt;
&lt;p&gt;Now that we have a properly ordered genome, we will build an index of it using &lt;a href="http://samtools.sourceforge.net/"&gt;&lt;code&gt;samtools&lt;/code&gt;&lt;/a&gt;. I&amp;#8217;m specifying a specific &lt;code&gt;samtools&lt;/code&gt;, because the bleeding edge version doesn&amp;#8217;t work on our server and we have to use version &lt;code&gt;0.1.19&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;/projects/ps-yeolab/software/samtools-0.1.19_built_by_hand/samtools faidx Homo_sapiens.GRCh37.75.fa
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Create a sequence dictionary of the genome using &lt;a href="http://broadinstitute.github.io/picard/"&gt;PicardTools&lt;/a&gt;. Our &lt;code&gt;PicardTools&lt;/code&gt; are located in &lt;code&gt;/projects/ps-yeolab/software/picard-tools-1.93/&lt;/code&gt;, yours are probably somewhere else. I&amp;#8217;m using the full path to be illustrative of the many components of bioinformatics&amp;nbsp;:)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;java -jar /projects/ps-yeolab/software/picard-tools-1.93/CreateSequenceDictionary.jar R=Homo_sapiens.GRCh37.75.fa O=Homo_sapiens.GRCh37.75.dict
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we are ready to run the &lt;code&gt;FastaAlternativeReferenceMaker&lt;/code&gt; command. My compiled &lt;code&gt;GATK&lt;/code&gt; distribution is in &lt;code&gt;~/workspace-git/gatk/dist&lt;/code&gt;, and again, yours is probably somewhere else. I&amp;#8217;ve separated this out onto several lines so it&amp;#8217;s easier to&amp;nbsp;read.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt; java -Xmx2g -jar ~/workspace-git/gatk/dist/GenomeAnalysisTK.jar \
    -R /projects/ps-yeolab/genomes/ensembl/v75/fasta/homo_sapiens/dna/Homo_sapiens.GRCh37.75.fa  \
    -T FastaAlternateReferenceMaker \
    -o /projects/ps-yeolab/genomes/ensembl/v75/fasta/homo_sapiens/dna/Venter.fasta \
    --variant /projects/ps-yeolab/genomes/ensembl/v75/variation/vcf/homo_sapiens/Venter.sorted.vcf
&lt;/pre&gt;&lt;/div&gt;</summary><category term="bioinformatics"></category><category term="genomics"></category><category term="ensembl"></category></entry></feed>